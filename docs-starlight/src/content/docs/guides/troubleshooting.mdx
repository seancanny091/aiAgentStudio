---
title: Troubleshooting
description: Common issues and resolutions.
---

import { Aside, Card, CardGrid, LinkButton, LinkCard, Steps, TabItem, Tabs } from '@astrojs/starlight/components';

# Troubleshooting

Common issues and how to resolve them.

<Aside type="tip" title="Triage Order">
Validate credentials first, then permissions, then model behavior, then performance tuning.
</Aside>

<LinkButton href="../configuration/" variant="secondary">Check Configuration</LinkButton>
<LinkButton href="../getting-started/" icon="right-arrow">Re-run Setup Flow</LinkButton>


## Agent Not Responding

**Symptoms**: Chat shows loading indefinitely · No response after sending message · Timeout errors

**Check Named Credential**
<Steps>
1. Go to **Setup → Named Credentials**.
2. Verify the credential is active.
3. Test the connection.
</Steps>

**Verify API Key**
<Steps>
1. Check that the API key is valid and not expired.
2. Verify the account has available credits.
3. Test the key directly with the provider's API.
</Steps>

**Check Agent Status**
<Steps>
1. Open the AI Agent Definition.
2. Ensure `IsActive__c` is checked.
3. Verify `LLMConfiguration__c` is set.
</Steps>

**Review Debug Logs**
<Steps>
1. Enable debug logging for your user in **Setup → Debug Logs**.
2. Reproduce the issue.
3. Check for errors in the log.
</Steps>

---

## Permission Denied Errors

**Symptoms**: "Insufficient privileges" messages · Agent can't access certain records · Fields missing from responses

**Check Object Permissions**

```sql
-- Query to check user's object access
SELECT Id, Name, Profile.Name
FROM User
WHERE Id = :userId
```

Then verify the profile/permission set grants CRUD on target objects.

**Check Field-Level Security**
<Steps>
1. Go to **Setup → Object Manager → [Object] → Fields**.
2. Click on the field.
3. Click **Field-Level Security**.
4. Ensure the user's profile has access.
</Steps>

**Check Sharing Rules**
<Steps>
1. Go to **Setup → Sharing Settings**.
2. Review OWD for the object.
3. Check sharing rules and verify the user has access to specific records.
</Steps>

---

## High CPU Time / Timeouts

**Symptoms**: "CPU time limit exceeded" errors · Slow responses · Incomplete executions

<CardGrid>
  <Card title="Reduce History" icon="seti:clock">
    Lower `HistoryTurnLimit__c` (try 5–7). Switch to `SummaryBuffer` memory strategy to compress older turns.
  </Card>
  <Card title="Simplify Capabilities" icon="seti:gear">
    Reduce the number of active capabilities. Simplify parameter schemas and shorten descriptions.
  </Card>
  <Card title="Use Async Processing" icon="rocket">
    Set `AsyncDispatchType__c` to `High`. Enable `RunAsynchronously__c` on heavy capabilities.
  </Card>
  <Card title="Optimize Queries" icon="seti:db">
    Add indexes to frequently queried fields. Limit fields in `BackendConfiguration__c` and use selective filters.
  </Card>
</CardGrid>

---

## Unexpected Tool Calls

**Symptoms**: Agent uses wrong capability · Agent calls tools unnecessarily · Inconsistent behavior

**Improve Descriptions**

<Tabs>
  <TabItem label="Poor example">

```text
Gets contacts
```

Too vague — the model will choose tools inconsistently or ignore them entirely.

  </TabItem>
  <TabItem label="Better example">

```text
Search for contacts by name, email, or account.
Use when users ask to find contact information.
Do NOT use for creating contacts or searching accounts.
```

  </TabItem>
</Tabs>

**Add Examples to Descriptions**
```
Examples of when to use:
- "Find John Smith's contact info"
- "Who is the contact at Acme Corp?"
- "Look up contacts with @gmail.com emails"
```

**Other Fixes**
- **Lower Temperature** — reduce `Temperature__c` to 0.3–0.5 for more predictable tool selection
- **Review Parameters** — ensure JSON Schema is valid, add clear descriptions to each parameter, use enums where appropriate

---

## Context Lost Between Turns

**Symptoms**: Agent forgets previous messages · Asks for information already provided · Doesn't maintain conversation flow

**Check Memory Strategy**
<Steps>
1. Open AI Agent Definition.
2. Verify `MemoryStrategy__c` is set (`BufferWindow` for precise context).
3. Raise `HistoryTurnLimit__c` (try 10–15).
</Steps>

**Verify Execution Steps**

```sql
SELECT Id, UserMessage__c, AssistantMessage__c
FROM ExecutionStep__c
WHERE AgentExecution__c = :executionId
ORDER BY CreatedDate ASC
```

Ensure steps are being created for each turn.

---

## JSON Parse Errors

**Symptoms**: "Invalid JSON" errors · Capability configuration failures · Parameter validation errors

Use a JSON validator to check `BackendConfiguration__c` and `Parameters__c`. Common mistakes:

<Tabs>
  <TabItem label="Trailing comma (invalid)">

```json
{
  "field": "value",
}
```

  </TabItem>
  <TabItem label="Valid JSON">

```json
{
  "field": "value"
}
```

  </TabItem>
  <TabItem label="Single quotes (invalid)">

```json
{
  'field': 'value'
}
```

  </TabItem>
</Tabs>

---

## Debug Tips

<CardGrid>
  <Card title="1. Use the Execution Storyboard" icon="seti:log">
    Open the **Execution Storyboard** UI for the affected `AgentExecution__c` record. It shows the full decision timeline — what the LLM received, what it responded, which tools were called, and any errors — without needing to write SOQL.
  </Card>
  <Card title="2. Enable Debug Logging" icon="seti:shell">
    Go to **Setup → Debug Logs**, add your user, and set Apex Code, Callout, and System all to `DEBUG`. Reproduce the issue and examine the log.
  </Card>
  <Card title="3. Test Capabilities Individually" icon="seti:gear">
    Use Developer Console to invoke a capability in isolation before wiring it to an agent. This isolates whether the issue is in the tool itself or in the LLM's routing.
  </Card>
  <Card title="4. Monitor Token Usage" icon="seti:graph-line">
    Token counts and estimated costs are recorded per execution step. Build a report or dashboard on the execution data objects to track spend by agent, user, or day.
  </Card>
  <Card title="5. Check Platform Events" icon="rocket">
    If using High Concurrency mode: **Setup → Platform Events** → check event delivery status and review any failed deliveries.
  </Card>
</CardGrid>

---

## Getting Help

Gather this information before opening an issue:

<Steps>
1. Agent configuration (type, memory strategy, history limit).
2. Capability configuration (description, parameters JSON).
3. Exact error messages.
4. Decision step data (query above).
5. Relevant debug log excerpts.
</Steps>

<CardGrid>
  <LinkCard title="GitHub Issues" href="https://github.com/iamsonal/aiAgentStudio/issues">
    Report bugs with reproduction steps.
  </LinkCard>
  <LinkCard title="GitHub Discussions" href="https://github.com/iamsonal/aiAgentStudio/discussions">
    Ask questions and share patterns.
  </LinkCard>
  <LinkCard title="Salesforce Developer Forums" href="https://developer.salesforce.com/forums">
    General Salesforce platform help.
  </LinkCard>
</CardGrid>
